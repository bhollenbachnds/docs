Ce manuel fournit des instructions √©tape par √©tape pour configurer **Single Sign-On** (SSO) pour **PADS4** en utilisant **Microsoft Entra ID** (anciennement Azure Active Directory).

***

## **1. Configuration Azure (Microsoft Entra ID)**

Pour permettre l'acc√®s √† PADS4 via Microsoft Entra :

### **√âtape par √©tape**

1. Allez sur [https://portal.azure.com](https://portal.azure.com) et connectez-vous en tant qu'administrateur.
2. Dans le menu de gauche, s√©lectionnez **Microsoft Entra ID**.

<img height="200" src="/images/ctrl-centre/sso/1.png" />

3. S√©lectionnez **Enterprise Applications**.

<img height="200" src="/images/ctrl-centre/sso/2.png" />

4. Cliquez sur **+ New Application**.

<img height="200" src="/images/ctrl-centre/sso/3.png" />

5. Choisissez **"Create your own application"**.

<img height="200" src="/images/ctrl-centre/sso/4.png" />

6. Remplissez les informations du formulaire

<img height="200" src="/images/ctrl-centre/sso/5.png" />

<img height="200" src="/images/ctrl-centre/sso/6.png" />

7. Cliquez sur Create

### **Attribuer des utilisateurs et des groupes**

8. Ouvrez votre application nouvellement cr√©√©e en retournant √† **Enterprise Applications** et en la recherchant.

<img height="200" src="/images/ctrl-centre/sso/8.png" />

9. S√©lectionnez **Users and Groups**.
   a. Cliquez sur **Add user/group**.
   <img height="200" src="/images/ctrl-centre/sso/9.png" />
   b. S√©lectionnez **None Selected**, puis recherchez et s√©lectionnez des utilisateurs ou des groupes.
   <img height="200" src="/images/ctrl-centre/sso/10.png" />
   c. Cliquez sur **Select**, puis **Assign**.
   <img height="200" src="/images/ctrl-centre/sso/11.png" />

> üí° Astuce : Cr√©ez un **PADS4 CMS group** d√©di√© dans Windows Server AD et assignez-le ici.

### **Configurer SAML SSO**

10. Allez √† **Single sign-on** dans le volet de gauche.
11. Choisissez **SAML**.

<img height="200" src="/images/ctrl-centre/sso/14.png" />

12. Sous **Basic SAML Configuration**, cliquez sur **Edit** et ajoutez :

* **Identifier (Entity ID)**:

  &#x20; `https://romy.pads365.com/saml`
* **Reply URL**:

  &#x20; `https://romy.pads365.com/rdx/nds.services.authentication.integration/api/v1/Saml2/Acs`

Cliquez sur **Save**.

<img height="200" src="/images/ctrl-centre/sso/15.png" />

***

## **2. Configuration des attributs et des revendications**

1. Tout en √©tant dans **Single sign-on**, allez √† **Attributes & Claims** et cliquez sur **Edit**.

<img height="200" src="/images/ctrl-centre/sso/16.png" />

2. Assurez-vous que les revendications correspondent √† la structure requise pour une connexion r√©ussie.

<img height="200" src="/images/ctrl-centre/sso/17.png" />

3. Plus pr√©cis√©ment, configurez la **group claim** properly:

> ‚ö†Ô∏è Si la revendication de groupe est mal configur√©e, la connexion sera redirig√©e avec cette erreur :
>
> &#x20; `No account is defined for your authentication request`

<img height="200" src="/images/ctrl-centre/sso/18.png" />

***

## **3. Configurer SSO dans PADS4 Portal**

### **Acc√©der √† PADS4**

1. Connectez-vous √† votre **PADS4 Dashboard** dans un navigateur web.
2. S√©lectionnez **Credentials** dans le menu de gauche.

<img height="200" src="/images/ctrl-centre/sso/19.png" />

3. Allez √† **Providers > Identity > Microsoft Entra**.

<img height="200" src="/images/ctrl-centre/sso/20.png" />

### **Saisir les informations du fournisseur**

Remplissez les champs suivants en utilisant les valeurs d'Azure :

* **Name** : √âtiquette conviviale affich√©e sur la page de connexion

* **Federation Service Identifier** :

  * Depuis **Single sign-on** > **Set up your\_app** section
  * Copiez le **Azure AD Identifier**

* **Reply URL** :
  Votre environnement PADS (par exemple, `https://pads4serverip`)

* **Metadata URL** :

  * Trouv√© sous **SAML Certificates**
  * Copiez l'**App Federation Metadata URL**

* **Certificates** :

  * T√©l√©chargez le **Microsoft Entra certificate** (.cer)
  * T√©l√©chargez le certificat de **private key** (.pfx) utilis√© pour HTTPS

  <img height="200" src="/images/ctrl-centre/sso/21.png" />

Cliquez sur **Create** pour sauvegarder.

***

## **4. Mappages et gestion des groupes**

1. Allez √† **Overview** sous **Credentials**.
2. Cliquez sur **Connect**, puis **New** pour cr√©er des **mappings and groups** pour ce fournisseur.

### **Trouver l'ID de groupe dans Azure**

3. Dans [portal.azure.com](https://portal.azure.com) :
   a. Allez √† **Microsoft Entra ID**
   b. S√©lectionnez **Groups**
   c. Recherchez votre groupe
   d. Copiez l'**Object ID** (c'est l'ID du groupe)
   <img height="200" src="/images/ctrl-centre/sso/28.png" />

### **Cr√©er un mappage de groupe**

4. Dans PADS4, cliquez sur **New Group**

<img height="200" src="/images/ctrl-centre/sso/29.png" />

5. Entrez l'**Group ID**
6. Attribuez des r√¥les √† partir de la liste d√©roulante

<img height="200" src="/images/ctrl-centre/sso/30.png" />

7. Sauvegardez le groupe. Vous pouvez ajouter **multiple roles per group**.

***

## **5. Finalisation du SSO**

* **D√©connectez-vous et rafra√Æchissez** le PADS4 Portal
* Le **SSO Login button** devrait maintenant √™tre visible

<img height="200" src="/images/ctrl-centre/sso/32.png" />

* Vous pouvez maintenant **vous connecter en utilisant les identifiants Azure**
